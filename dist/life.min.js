const t=20,e=5;let s=!1,a=!1;function r(t){let e=new Array(t);for(let s=0;s<t;s++)e[s]=new Array(t).fill(0);return e}function i(t){return t.map(t=>Array.from(t))}function o(e){for(;e<0;)e+=t;for(;e>t-1;)e-=t;return e}document.body.addEventListener("mousedown",t=>{s=!0,a=t.button<2,t.target!==t.currentTarget&&t.target.classList.toggle("alive",a)}),document.body.addEventListener("mouseup",()=>{s=!1,a=!1});class n{constructor(t,e,s){this.alive=1===t,this.coord={x:e,y:s}}spany(){const t=document.createElement("span");return this.alive&&t.classList.add("alive"),t.addEventListener("mouseover",()=>{s&&(t.classList.toggle("alive",a),c.board.toggle(this.coord.x,this.coord.y,a))}),t}}class l{constructor(){this.data=[]}push(t){this.data.push(t)}spany(){let t=[];for(let e of this.data)t.push(e.spany());return t}}class h{constructor(t,e){this.self=t,this.state=e}toggle(t,e,s=!0){this.state[e][t]=s?1:0}render(){let e=i(this.state);for(let s=0;s<t;s++)for(let a=0;a<t;a++){let t=this.state[o(s-1)][o(a-1)]+this.state[o(s-1)][a]+this.state[o(s-1)][o(a+1)]+this.state[s][o(a-1)]+this.state[s][o(a+1)]+this.state[o(s+1)][o(a-1)]+this.state[o(s+1)][a]+this.state[o(s+1)][o(a+1)];0==e[s][a]&&3==t?e[s][a]=1:1==e[s][a]&&(t<2||t>3)&&(e[s][a]=0)}this.state=i(e),this.paint()}paint(){let t=new l;this.state.forEach((e,s)=>{e.forEach((e,a)=>{t.push(new n(e,a,s))})}),this.self.innerHTML="",this.self.append(...t.spany())}}class d{constructor(){let e=document.createElement("div");e.setAttribute("id","root"),e.style.maxWidth=`${20*t}px`,this.control=document.createElement("div"),this.control.innerText="Play",this.control.setAttribute("id","control"),this.control.addEventListener("click",()=>{this.control.innerText=this.pause()?"Play":"Pause"}),this.board=new h(e,r(t)),this.isPaused=!0,document.body.append(e,this.control)}play(){this.interval=setInterval(()=>{this.board.render()},Math.floor(1e3/e))}pause(){return this.isPaused=!this.isPaused,this.isPaused?clearInterval(this.interval):this.play(),this.isPaused}start(){this.isPaused?this.board.paint():this.play()}}const c=new d;c.board.toggle(0,1),c.board.toggle(1,2),c.board.toggle(2,0),c.board.toggle(2,1),c.board.toggle(2,2),c.start();