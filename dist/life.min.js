const t=20,e=5;function s(t){let e=new Array(t);for(let s=0;s<t;s++)e[s]=new Array(t).fill(!1);return e}function r(t){return t.map(t=>Array.from(t))}function a(e){for(;e<0;)e+=t;for(;e>t-1;)e-=t;return e}let i=!1,o=!1;class n{constructor(t,e,s){this.state=t,this.coord={x:e,y:s}}spany(){const t=document.createElement("span");return this.state&&t.classList.add("alive"),t.addEventListener("mousedown",t=>{i=!0,o=t.button<2,t.target===t.currentTarget&&u.board.toggle(this.coord.x,this.coord.y,o)}),t.addEventListener("mouseover",()=>{i&&u.board.toggle(this.coord.x,this.coord.y,o)}),t.addEventListener("mouseup",()=>{i=!1,o=!1}),t}}class h{constructor(){this.data=[]}push(t){this.data.push(t)}spany(){let t=[];for(let e of this.data)t.push(e.spany());return t}}class l{constructor(t,e){this.self=t,this.state=e}toggle(t,e,s=!0){this.state[e][t]=s,this.paint()}render(){let e=r(this.state);for(let s=0;s<t;s++)for(let r=0;r<t;r++){let t=Number(this.state[a(s-1)][a(r-1)])+Number(this.state[a(s-1)][r])+Number(this.state[a(s-1)][a(r+1)])+Number(this.state[s][a(r-1)])+Number(this.state[s][a(r+1)])+Number(this.state[a(s+1)][a(r-1)])+Number(this.state[a(s+1)][r])+Number(this.state[a(s+1)][a(r+1)]);e[s][r]||3!==t?e[s][r]&&(t<2||t>3)&&(e[s][r]=!1):e[s][r]=!0}this.state=r(e),this.paint()}paint(){let t=new h;this.state.forEach((e,s)=>{e.forEach((e,r)=>{t.push(new n(e,r,s))})}),this.self.innerHTML="",this.self.append(...t.spany())}}class d{constructor(){let e=document.createElement("div");e.setAttribute("id","root"),e.style.maxWidth=`${20*t}px`,this.control=document.createElement("div"),this.control.innerText="Play",this.control.setAttribute("id","control"),this.control.addEventListener("click",()=>{this.control.innerText=this.pause()?"Play":"Pause"}),this.board=new l(e,s(t)),this.isPaused=!0,document.body.append(e,this.control)}play(){this.interval=setInterval(()=>{this.board.render()},Math.floor(1e3/e))}pause(){return this.isPaused=!this.isPaused,this.isPaused?clearInterval(this.interval):this.play(),this.isPaused}start(){this.isPaused?this.board.paint():this.play()}}const u=new d;u.board.toggle(0,1),u.board.toggle(1,2),u.board.toggle(2,0),u.board.toggle(2,1),u.board.toggle(2,2),u.start();